#http://stat.ethz.ch/R-manual/R-patched/library/stats/html/scatter.smooth.html
#http://research.stowers-institute.org/efg/R/Statistics/loess.htm
#http://stat.ethz.ch/R-manual/R-patched/library/stats/html/loess.html
perl covBEDforDIME.pl chromsizes19M.tab > 500bp_window.bed &
#each takes about 6min, do not run in parallel (disk bound, splits into multiple processes)
intersectBed -v -abam ../wgEncodeHaibTfbsA549GrPcr2xDex100nmAlnRep1.bam -b ../artifact2.bed | coverageBed -abam stdin -b 500bp_window.bed | sortBed > ./data/high1.cov 
intersectBed -v -abam ../wgEncodeHaibTfbsA549GrPcr2xDex100nmAlnRep2.bam -b ../artifact2.bed | coverageBed -abam stdin -b 500bp_window.bed | sortBed > ./data/high2.cov 
intersectBed -v -abam ../wgEncodeHaibTfbsA549GrPcr1xDex50nmAlnRep1.bam -b ../artifact2.bed | coverageBed -abam stdin -b 500bp_window.bed | sortBed > ./data/mid1.cov
intersectBed -v -abam ../wgEncodeHaibTfbsA549GrPcr1xDex50nmAlnRep2.bam -b ../artifact2.bed | coverageBed -abam stdin -b 500bp_window.bed | sortBed > ./data/mid2.cov
intersectBed -v -abam ../wgEncodeHaibTfbsA549GrPcr1xDex500pmAlnRep1.bam -b ../artifact2.bed | coverageBed -abam stdin -b 500bp_window.bed | sortBed > ./data/low1.cov
intersectBed -v -abam ../wgEncodeHaibTfbsA549GrPcr1xDex500pmAlnRep2.bam -b ../artifact2.bed | coverageBed -abam stdin -b 500bp_window.bed | sortBed > ./data/low2.cov
intersectBed -v -abam ../wgEncodeHaibTfbsA549GrPcr1xEtoh02AlnRep1.bam -b ../artifact2.bed | coverageBed -abam stdin -b 500bp_window.bed | sortBed > ./data/none1.cov
intersectBed -v -abam ../wgEncodeHaibTfbsA549GrPcr1xEtoh02AlnRep2.bam -b ../artifact2.bed | coverageBed -abam stdin -b 500bp_window.bed | sortBed > ./data/none2.cov
#split by chr
mkdir high1; mkdir high2; mkdir mid1; mkdir mid2; mkdir low1; mkdir low2; mkdir none1; mkdir none2;
perl splitcov.pl
loess.R #modify for every screen, this is matlab code converted

There were 50 or more warnings (use warnings() to see the first 50)
> warnings()
Warning messages:
1: In simpleLoess(y, x, w, span, degree, parametric, drop.square,  ... : at  -29.643
2: In simpleLoess(y, x, w, span, degree, parametric, drop.square,  ... :
  radius  878.68
3: In simpleLoess(y, x, w, span, degree, parametric, drop.square,  ... :
  all data on boundary of neighborhood. make span bigger
4: In simpleLoess(y, x, w, span, degree, parametric, drop.square,  ... :
  pseudoinverse used at -29.643
5: In simpleLoess(y, x, w, span, degree, parametric, drop.square,  ... :
  neighborhood radius 29.643
6: In simpleLoess(y, x, w, span, degree, parametric, drop.square,  ... :
  reciprocal condition number  1
7: In simpleLoess(y, x, w, span, degree, parametric, drop.square,  ... :
  There are other near singularities as well. 0.25
8: In simpleLoess(y, x, w, span, degree, parametric, drop.square,  ... :
  zero-width neighborhood. make span bigger
9: In simpleLoess(y, x, w, span, degree, parametric, drop.square,  ... :
  pseudoinverse used at -4.175
10: In simpleLoess(y, x, w, span, degree, parametric, drop.square,  ... :
  neighborhood radius 4.675
11: In simpleLoess(y, x, w, span, degree, parametric, drop.square,  ... :
  reciprocal condition number  3.8005e-27
12: In simpleLoess(y, x, w, span, degree, parametric, drop.square,  ... :
  There are other near singularities as well. 0.25
13: In simpleLoess(y, x, w, span, degree, parametric, drop.square,  ... :
  pseudoinverse used at -4.9775
14: In simpleLoess(y, x, w, span, degree, parametric, drop.square,  ... :
  neighborhood radius 5.4775

